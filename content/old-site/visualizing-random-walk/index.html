<!DOCTYPE html>
<html>
  <head>
    <title>Visualizing Random Walk</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <link rel="stylesheet" href="../Computer Modern/Serif/cmun-serif.css">
  </head>
  <body>
    <nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-dark">
      <div class="container-fluid">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav">
            <a class="nav-link" href="..">Home</a>
          </div>
        </div>
      </div>
    </nav>
    <br>
    <div id="parent" class="container p-3 text-center">
      <p class="m-3">
        <b>One of those gambler setups.</b> You worked all summer at McDonald's to earn $5. You decide to gamble it all away by playing the hottest new game, chess.<br>
        Since your chess skills are only average, you either win or lose $1 each game, with equal probability. You stop when you go broke or you make bank with $10.
      </p>
      <canvas id="randomWalk" width=1000, height=150></canvas>
      <img id="dollars" src="assets/dollar bills 5.png" alt="dollars" width=500, style="display:block;max-width:100%;height:auto;margin:auto auto"></img>
      <script>
let canvas = document.getElementById("randomWalk");
let ctx = canvas.getContext("2d");
let image = document.getElementById("dollars");
let n = 11, m = 5;
let states = new Array(n);

let parent = document.getElementById("parent");
canvas.width = parent.offsetWidth - parent.offsetLeft;

let padding = canvas.width * 0.05;
let radius = Math.min((canvas.width - 2 * padding - (n - 1) * canvas.width * 0.06) / 10, 20);
let activeStateColor = "red";
let inactiveStateColor = "#0095DD";
let intervalId;
for (let i = 0; i < n; i++) {
    states[i] = { x: (canvas.width - 2 * padding) * i / (n-1) + padding, y: canvas.height / 2 - 20, active: false};
}

function drawStates() {
    for (let i = 0; i < n; i++) {
    ctx.beginPath();
    ctx.arc(states[i].x, states[i].y, radius, 0, Math.PI*2);
    ctx.fillStyle = (states[i].active) ? activeStateColor : inactiveStateColor;
    ctx.fill();
    ctx.font = radius + "px Comic Sans";
    ctx.fillStyle = "black";
    ctx.textAlign = "center";
    ctx.fillText(i, states[i].x, states[i].y + radius / 4);
    ctx.closePath();
    }
}

function drawArrows() {
    for (let i = 0; i < n - 1; i++) {
        ctx.beginPath();
        ctx.moveTo(states[i].x + radius, states[i].y);
        ctx.lineTo(states[i + 1].x - radius, states[i].y);
        ctx.stroke();
        if (i < n - 2) {
            // drawing left arrow heads
            ctx.moveTo(states[i].x + radius + canvas.width * 0.005, states[i].y - canvas.width * 0.005);
            ctx.lineTo(states[i].x + radius, states[i].y);
            ctx.lineTo(states[i].x + radius + canvas.width * 0.005, states[i].y + canvas.width * 0.005);
            ctx.stroke();
        }
        if (i > 0) {
            // drawing right arrow heads
            ctx.moveTo(states[i+1].x - radius - canvas.width * 0.005, states[i+1].y - canvas.width * 0.005);
            ctx.lineTo(states[i+1].x - radius, states[i].y);
            ctx.lineTo(states[i+1].x - radius - canvas.width * 0.005, states[i+1].y + canvas.width * 0.005);
            ctx.stroke();
            ctx.closePath();
        }
    }
}

function draw() {
    states[m].active = true;

    drawStates();
    image.src = ("../../img/dollar bills " + m + ".png");

    if (m > 0 && m < n - 1) {
        states[m].active = false;
        if (Math.random() < 1/2) {
            m++;
        } else {
            m--;
        }
    } else {
        if (m == 0) {
            ctx.font = "16px Arial";
            ctx.fillStyle = "black";
            ctx.fillText("You are now broke.", canvas.width / 2, canvas.height - 20);
        } else if (m == n - 1) {
            ctx.font = "16px Arial";
            ctx.fillStyle = "black";
            ctx.fillText("You doubled your money!", canvas.width / 2, canvas.height - 20);
        }
        clearInterval(intervalId);
    }
}
drawArrows();
draw();
intervalId = setInterval(draw, 1000);
      </script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    </div>
  </body>
</html>
